<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orders â€” Magelan Admin</title>

    <link href="https://fonts.googleapis.com/css2?family=Pirata+One&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/styles.css}" href="/styles.css">
    <link rel="stylesheet" th:href="@{/admin-panel.css}" href="/admin-panel.css">
</head>
<body class="admin-body">
<div class="admin-container">
    <div class="logo-container">
        <a th:href="@{/home}">
            <img src="/magelan-index.jpg" alt="Magelan Logo" class="logo-image">
        </a>
    </div>

    <section class="panel">
        <h1 class="title">Orders</h1>

        <div th:if="${message != null and !#strings.isEmpty(message)}" class="alert success">
            <p th:text="${message}">Message</p>
        </div>
        <div th:if="${error != null and !#strings.isEmpty(error)}" class="alert error">
            <p th:text="${error}">Error</p>
        </div>

        <div class="admin-actions">
            <a th:href="@{/admin/panel}" class="btn-secondary">Back to Admin Panel</a>
        </div>

        <div class="history-section" th:if="${submittedOrders != null and !#lists.isEmpty(submittedOrders)}">
            <h2 class="subtitle">Submitted Orders</h2>
            <div class="table-wrapper">
                <table class="users-table">
                    <thead>
                    <tr>
                        <th>Date</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th class="col-right">Total</th>
                        <th class="col-right">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="o : ${submittedOrders}">
                        <td th:text="${#temporals.format(o.createdOn, 'dd.MM.yyyy HH:mm')}">01.01.2025 19:30</td>
                        <td th:text="${o.customer != null ? o.customer.username : 'Unknown'}">username</td>
                        <td th:text="${o.orderStatus}">SUBMITTED</td>
                        <td class="col-right" th:text="${#numbers.formatDecimal(o.amount, 1, 2)}">0.00</td>
                        <td class="col-right">
                            <div class="action-buttons">
                                <a th:href="@{|/admin/orders/${o.id}|}" class="btn-toggle">View</a>

                                <form th:action="@{|/admin/orders/${o.id}|}" method="post" class="inline-form">
                                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                    <input type="hidden" name="_method" value="patch"/>
                                    <input type="hidden" name="status" value="CONFIRMED"/>
                                    <button type="submit" class="btn-toggle">Confirm</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="history-section" th:if="${confirmedOrders != null and !#lists.isEmpty(confirmedOrders)}">
            <h2 class="subtitle">Confirmed Orders</h2>
            <div class="table-wrapper">
                <table class="users-table">
                    <thead>
                    <tr>
                        <th>Date</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th class="col-right">Total</th>
                        <th class="col-right">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="o : ${confirmedOrders}">
                        <td th:text="${#temporals.format(o.createdOn, 'dd.MM.yyyy HH:mm')}">01.01.2025 19:30</td>
                        <td th:text="${o.customer != null ? o.customer.username : 'Unknown'}">username</td>
                        <td th:text="${o.orderStatus}">CONFIRMED</td>
                        <td class="col-right" th:text="${#numbers.formatDecimal(o.amount, 1, 2)}">0.00</td>
                        <td class="col-right">
                            <div class="action-buttons">
                                <form th:action="@{|/admin/orders/${o.id}|}" method="post" class="inline-form">
                                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                    <input type="hidden" name="_method" value="patch"/>
                                    <input type="hidden" name="status" value="DELIVERED"/>
                                    <button type="submit" class="btn-toggle demote">Deliver</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="history-section" th:if="${deliveredOrders != null and !#lists.isEmpty(deliveredOrders)}">
            <h2 class="subtitle">Delivered Orders</h2>
            <div class="table-wrapper">
                <table class="users-table">
                    <thead>
                    <tr>
                        <th>Date</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th class="col-right">Total</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="o : ${deliveredOrders}">
                        <td th:text="${#temporals.format(o.createdOn, 'dd.MM.yyyy HH:mm')}">01.01.2025 19:30</td>
                        <td th:text="${o.customer != null ? o.customer.username : 'Unknown'}">username</td>
                        <td th:text="${o.orderStatus}">DELIVERED</td>
                        <td class="col-right" th:text="${#numbers.formatDecimal(o.amount, 1, 2)}">0.00</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </section>
</div>
</body>
</html>
